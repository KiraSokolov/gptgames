<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Monkeytype Clone</title>
    <style>
        body {
            background-color: #333333;
        }

        #text {
            font-size: 30px;
            color: #AAAAAA;
            background-color: #222222;
            width: 50%;
            margin: 0 auto;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            white-space: pre-line;
        }

        #timer {
            font-size: 24px;
            color: #FFFF00;
            float: left;
            margin-left: 10px;
        }

        #stats {
            font-size: 24px;
            color: #FFFFFF;
            float: right;
            margin-right: 10px;
        }

        .correct {
            color: #FFFFFF;
        }

        .incorrect {
            color: #FF0000;
        }
    </style>
</head>
<body onkeypress="startTimer(event)">
<div id="text"></div>
<div id="timer">30s</div>
<div id="stats"></div>
<script>
    var words = ["tell", "many", "say", "point", "run", "should", "can", "line", "world", "but", "now", "program", "make", "nation", "not", "while", "stand", "there", "hand", "feel", "under", "must", "work", "go", "show", "can", "general"];
    var text = "";
    var index = 0;
    var correctCount = 0;
    var incorrectCount = 0;
    var wordCount = 0;
    var characterCount = 0;
    var startTime = null;
    var timerId = null;
    var textElement = document.getElementById("text");
    var timerElement = document.getElementById("timer");
    var statsElement = document.getElementById("stats");

    function generateText() {
        var rows = [];
        for (var i = 0; i < 3; i++) {
            var wordsInRow = [];
            for (var j = 0; j < 15; j++) {
                var randomIndex = Math.floor(Math.random() * words.length);
                wordsInRow.push(words[randomIndex]);
            }
            rows.push(wordsInRow.join(" "));
        }
        return rows.join("\n");
    }

    function updateText() {
        text = generateText();
        textElement.textContent = text;
    }

    function resetStats() {
        correctCount = 0;
        incorrectCount = 0;
        wordCount = 0;
        characterCount = 0;
        statsElement.textContent = "";
    }

    function resetTimer() {
        if (timerId) {
            clearInterval(timerId);
        }
        timerElement.textContent = "30s";
        startTime = null;
        timerId = null;
    }

    function startTimer(event) {
        if (event.target.tagName === "BODY" && !startTime) {
            resetStats();
            resetTimer();
            updateText();
            startTime = Date.now();
            timerId = setInterval(function () {
                var elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
                var remainingSeconds = 30 - elapsedSeconds;
                if (remainingSeconds <= 0) {
                    clearInterval(timerId);
                    timerElement.textContent = "0s";
                    showStats();
                } else {
                    timerElement.textContent = remainingSeconds + "s";
                }
            }, 1000);
        } else {
            var typedChar = String.fromCharCode(event.keyCode).toLowerCase();
            var currentChar = text.charAt(index);
            if (currentChar === " ") {
                wordCount++;
            } else {
                characterCount++;
            }
            if (typedChar === currentChar) {
                textElement.innerHTML = textElement.innerHTML.substring(0, index) + '<span class="correct">' + currentChar + '</span>' + textElement.innerHTML.substring(index + 1);
                correctCount++;
            } else {
                textElement.innerHTML = textElement.innerHTML.substring(0, index) + '<span class="incorrect">' + currentChar + '</span>' + textElement.innerHTML.substring(index + 1);
                incorrectCount++;
            }
            index++;
            if (index === text.length) {
                resetTimer();
                showStats();
            }
        }
    }

    function showStats() {
        var elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
        var wpm = Math.floor((wordCount / elapsedSeconds) * 60);
        var accuracy = Math.floor((correctCount / (correctCount + incorrectCount)) * 100);
        var statsText = "WPM: " + wpm + " | Accuracy: " + accuracy + "% | Typed Characters: " + characterCount + " (Correct: " + correctCount + ", Incorrect: " + incorrectCount + ")";
        statsElement.textContent = statsText;
    }
</script>
</body>
</html>