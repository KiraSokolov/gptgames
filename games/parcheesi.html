<!DOCTYPE html>
<html>
<head>
  <title>Parcheesi</title>
  <style>
    .square {
      width: 50px;
      height: 50px;
      border: 1px solid black;
      display: inline-block;
    }
    .safe {
      background-color: lightgray;
    }
    .player {
      display: inline-block;
      margin: 10px;
      vertical-align: top;
    }
    .piece {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin: 2px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<h1>Parcheesi</h1>
<div id="board"></div>
<div>
  <button id="diceButton">Roll Dice</button>
  <div id="diceRoll">Roll the dice!</div>
  <button id="endTurnButton">End Turn</button>
  <div id="currentPlayer">Current player:</div>
</div>
<script>
  // Define the variables
  let currentPlayer = 0;
  let playerScores = [0, 0, 0, 0];
  let playerPositions = [[], [], [], []];
  let playerColors = ["red", "blue", "green", "yellow"];
  let diceRoll;

  // Roll the dice
  function rollDice() {
    diceRoll = Math.floor(Math.random() * 6) + 1;
    document.getElementById("diceRoll").innerHTML = "You rolled a " + diceRoll + "!";
  }

  // Move the player's piece
  function movePiece(playerIndex, pieceIndex) {
    if (playerScores[playerIndex] < 56 && playerPositions[playerIndex][pieceIndex] + diceRoll > 55) {
      alert("You can't move that piece because it would go past the finish line!");
    } else if (playerPositions[playerIndex][pieceIndex] === -1 && diceRoll !== 5) {
      alert("You can't move that piece until you roll a 5!");
    } else {
      playerPositions[playerIndex][pieceIndex] += diceRoll;
      if (playerPositions[playerIndex][pieceIndex] > 55) {
        playerPositions[playerIndex][pieceIndex] = 55 - (playerPositions[playerIndex][pieceIndex] - 55);
        playerScores[playerIndex]++;
        document.getElementById("player" + playerIndex + "Score").innerHTML = "Score: " + playerScores[playerIndex];
        alert("You finished a piece! Move again.");
      }
      let piece = document.getElementById("player" + playerIndex + "Piece" + pieceIndex);
      let square = document.getElementById("square" + playerPositions[playerIndex][pieceIndex]);
      square.appendChild(piece);
    }
  }

  // End the current player's turn
  function endTurn() {
    currentPlayer++;
    if (currentPlayer === 4) {
      currentPlayer = 0;
    }
    document.getElementById("currentPlayer").innerHTML = "Current player: " + playerColors[currentPlayer];
    document.getElementById("diceRoll").innerHTML = "Roll the dice!";
  }

  // Set up the game board
  function setupBoard() {
    let board = document.getElementById("board");
    for (let i = 0; i < 68; i++) {
      let square = document.createElement("div");
      square.id = "square" + i;
      square.classList.add("square");
      if (i === 5 || i === 18 || i === 31 || i === 44) {
        square.classList.add("safe");
      }
      board.appendChild(square);
    }
    for (let i = 0; i < 4; i++) {
      let player = document.createElement("div");
      player.id = "player" + i;
      player.classList.add("player");
      let score = document.createElement("div");
      score.id = "player" + i + "Score";
      score.innerHTML = "Score: 0";
      player.appendChild(score);
      for (let j = 0; j < 4; j++) {
        let piece = document.createElement("div");
        piece.id = "player" + i + "Piece" + j;
        piece.classList.add("piece");
        piece.style.backgroundColor = playerColors[i];
        piece.addEventListener("click", function() {
          movePiece(i, j);
        });
        player.appendChild(piece);
        playerPositions[i].push(-1);
      }
      board.appendChild(player);
    }
    document.getElementById("currentPlayer").innerHTML = "Current player: " + playerColors[currentPlayer];
    document.getElementById("diceRoll").innerHTML = "Roll the dice!";
  }

  // Start the game
  function startGame() {
    setupBoard();
    document.getElementById("diceButton").addEventListener("click", function() {
      rollDice();
    });
    document.getElementById("endTurnButton").addEventListener("click", function() {
      endTurn();
    });
  }

  // Call the startGame function when the page loads
  window.addEventListener("load", startGame);
</script>
</body>
</html>