<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>2048 Game</title>
  <style>#game-container {
      width: 410px;
      height: 400px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
  }

  .grid-item {
      width: 100px;
      height: 100px;
      background-color: #eee;
      border: 1px solid #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 36px;
      color: #333;
  }

  .grid-item-2 {
      background-color: #f2b179;
  }

  .grid-item-4 {
      background-color: #f59563;
  }

  .grid-item-8 {
      background-color: #f67c5f;
  }

  .grid-item-16 {
      background-color: #f65e3b;
  }

  .grid-item-32 {
      background-color: #edcf72;
  }

  .grid-item-64 {
      background-color: #edcc61;
  }

  .grid-item-128 {
      background-color: #edc850;
  }

  .grid-item-256 {
      background-color: #edc53f;
  }

  .grid-item-512 {
      background-color: #edc22e;
  }

  .grid-item-1024 {
      background-color: #3c3a32;
      color: #fff;
  }

  .grid-item-2048 {
      background-color: #0f0c5d;
      color: #fff;
  }</style>
</head>
<body>
<div id="game-container"></div>
<script>const gameContainer = document.querySelector('#game-container');
let grid = [];
let score = 0;

function createGrid() {
  for (let i = 0; i < 4; i++) {
    for (let j = 0; j < 4; j++) {
      const gridItem = document.createElement('div');
      gridItem.classList.add('grid-item');
      gridItem.setAttribute('data-row', i);
      gridItem.setAttribute('data-col', j);
      gameContainer.appendChild(gridItem);
      grid.push(gridItem);
    }
  }
}

function addNumber() {
  const emptyGrids = grid.filter(gridItem => gridItem.innerHTML === '');
  if (emptyGrids.length === 0) {
    return;
  }
  const randomIndex = Math.floor(Math.random() * emptyGrids.length);
  const randomGrid = emptyGrids[randomIndex];
  randomGrid.innerHTML = '2';
  randomGrid.classList.add('grid-item-2');
}

function moveLeft() {
  for (let i = 0; i < 4; i++) {
    for (let j = 1; j < 4; j++) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      let k = j;
      while (k > 0) {
        const prevGrid = getGrid(i, k - 1);
        if (prevGrid.innerHTML !== '') {
          break;
        }
        prevGrid.innerHTML = currentValue;
        prevGrid.className = currentGrid.className;
        currentGrid.innerHTML = '';
        currentGrid.className = 'grid-item';
        k--;
      }
    }
  }
}

function moveUp() {
  for (let i = 1; i < 4; i++) {
    for (let j = 0; j < 4; j++) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      let k = i;
      while (k > 0) {
        const prevGrid = getGrid(k - 1, j);
        if (prevGrid.innerHTML !== '') {
          break;
        }
        prevGrid.innerHTML = currentValue;
        prevGrid.className = currentGrid.className;
        currentGrid.innerHTML = '';
        currentGrid.className = 'grid-item';
        k--;
      }
    }
  }
}

function moveDown() {
  for (let i = 2; i >= 0; i--) {
    for (let j = 0; j < 4; j++) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      let k = i;
      while (k < 3) {
        const nextGrid = getGrid(k + 1, i);
        if (nextGrid.innerHTML !== '') {
          break;
        }
        nextGrid.innerHTML = currentValue;
        nextGrid.className = currentGrid.className;
        currentGrid.innerHTML = '';
        currentGrid.className = 'grid-item';
        k++;
      }
    }
  }
}

function moveRight() {
  for (let i = 0; i < 4; i++) {
    for (let j = 2; j >= 0; j--) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      let k = j;
      while (k < 3) {
        const nextGrid = getGrid(j, k + 1);
        if (nextGrid.innerHTML !== '') {
          break;
        }
        nextGrid.innerHTML = currentValue;
        nextGrid.className = currentGrid.className;
        currentGrid.innerHTML = '';
        currentGrid.className = 'grid-item';
        k++;
      }
    }
  }
}

function mergeLeft() {
  for (let i = 0; i < 4; i++) {
    for (let j = 1; j < 4; j++) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      const prevGrid = getGrid(i, j - 1);
      if (prevGrid.innerHTML === '') {
        continue;
      }
      const prevValue = parseInt(prevGrid.innerHTML);
      if (prevValue !== currentValue) {
        continue;
      }
      prevGrid.innerHTML = prevValue * 2;
      prevGrid.className = `grid-item grid-item-${prevValue * 2}`;
      currentGrid.innerHTML = '';
      currentGrid.className = 'grid-item';
      score += prevValue * 2;
    }
  }
}

function mergeRight() {
  for (let i = 0; i < 4; i++) {
    for (let j = 2; j >= 0; j--) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      const nextGrid = getGrid(i, j + 1);
      if (nextGrid.innerHTML === '') {
        continue;
      }
      const nextValue = parseInt(nextGrid.innerHTML);
      if (nextValue !== currentValue) {
        continue;
      }
      nextGrid.innerHTML = nextValue * 2;
      nextGrid.className = `grid-item grid-item-${nextValue * 2}`;
      currentGrid.innerHTML = '';
      currentGrid.className = 'grid-item';
      score += nextValue * 2;
    }
  }
}

function mergeUp() {
  for (let i = 1; i < 4; i++) {
    for (let j = 0; j < 4; j++) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      const prevGrid = getGrid(i - 1, j);
      if (prevGrid.innerHTML === '') {
        continue;
      }
      const prevValue = parseInt(prevGrid.innerHTML);
      if (prevValue !== currentValue) {
        continue;
      }
      prevGrid.innerHTML = prevValue * 2;
      prevGrid.className = `grid-item grid-item-${prevValue * 2}`;
      currentGrid.innerHTML = '';
      currentGrid.className = 'grid-item';
      score += prevValue * 2;
    }
  }
}

function mergeDown() {
  for (let i = 2; i >= 0; i--) {
    for (let j = 0; j < 4; j++) {
      const currentGrid = getGrid(i, j);
      if (currentGrid.innerHTML === '') {
        continue;
      }
      const currentValue = parseInt(currentGrid.innerHTML);
      const nextGrid = getGrid(i + 1, j);
      if (nextGrid.innerHTML === '') {
        continue;
      }
      const nextValue = parseInt(nextGrid.innerHTML);
      if (nextValue !== currentValue) {
        continue;
      }
      nextGrid.innerHTML = nextValue * 2;
      nextGrid.className = `grid-item grid-item-${nextValue * 2}`;
      currentGrid.innerHTML = '';
      currentGrid.className = 'grid-item';
      score += nextValue * 2;
    }
  }
}

function move(direction) {
  if (direction === 'left') {
    moveLeft();
    mergeLeft();
  } else if (direction === 'right') {
    moveRight();
    mergeRight();
  } else if (direction === 'up') {
    moveUp();
    mergeUp();
  } else if (direction === 'down') {
    moveDown();
    mergeDown();
  }
  addNumber();
}

function getGrid(row, col) {
  return grid.find(gridItem => {
    return gridItem.getAttribute('data-row') == row && gridItem.getAttribute('data-col') == col;
  });
}

document.addEventListener('keydown', e => {
  if (e.keyCode === 37) {
    move('left');
  } else if (e.keyCode === 38) {
    move('up');
  } else if (e.keyCode === 39) {
    move('right');
  } else if (e.keyCode === 40) {
    move('down');
  }
});
createGrid();
addNumber();</script>
</body>
</html>