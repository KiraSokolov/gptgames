<!DOCTYPE html>
<html>
<head>
  <title>DescriptoCraft</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f4f4;
      color: #333;
      line-height: 1.6;
    }
    #app {
      max-width: 600px;
      margin: 0 auto;
      padding: 1em;
      background: white;
      box-shadow: 0px 0px 20px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #333;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    form input, form select, form button {
      padding: 10px;
      font-size: 1em;
    }
    form button, #app > button {
      cursor: pointer;
      background: #333;
      color: white;
      border: none;
    }
    .adjective-item {
      padding: 10px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      cursor: pointer;
      margin: 5px 0;
    }
    #adjectiveList {
      margin-top: 20px;
    }
  </style>
</head>
<body>
<div id="app">
  <h1>DescriptoCraft</h1>
  <form @submit.prevent="generateAdjectives">
    <input type="text" v-model="word" placeholder="Enter word" required>
    <select v-model="method">
      <option value="synonym">Synonym</option>
      <option value="theme">Theme/Setting</option>
      <option value="object">Object</option>
    </select>
    <input type="number" v-model="numAdjectives" min="1" placeholder="Number of adjectives" required>
    <button type="submit">Generate</button>
  </form>
  <button @click="clearAll">Clear All</button>
  <div id="adjectiveList">
    <div class="adjective-item" v-for="(adjective, index) in adjectives" @click="copyToClipboard(adjective)">
      {{ adjective }}
    </div>
  </div>
</div>
<script src="https://unpkg.com/vue@next"></script>
<script>
  const app = Vue.createApp({
    data() {
      return {
        word: '',
        method: 'synonym',
        numAdjectives: 1,
        adjectives: [],
      };
    },
    methods: {
      async generateAdjectives() {
        const API_ENDPOINT = 'https://chatgpt.tobiasmue91.workers.dev/';
        const systemMessage = `You are the DescriptoCraft AI. You possess 3 different methods of generating adjectives: 1. "synonym" - generate synonyms based on the given word; 2. "theme" - generate fitting adjectives for a given theme, location, or setting; 3. "object" - generate adjectives that describe the given object or thing`;
        let assistantMessage = `I will generate ${this.numAdjectives} adjectives for the word "${this.word}" using the "${this.method}" method. I will only output the generated adjectives in a comma seperated format.\n`;
        try {
          const response = await fetch(API_ENDPOINT, {
            method: 'POST',
            headers: {
              "Content-Type": "application/json",
              "Accept": "*/*"
            },
            body: JSON.stringify({
              model: "gpt-3.5-turbo",
              max_tokens: 500,
              messages: [{role: "system", content: systemMessage},{role: "assistant", content: assistantMessage}],
            }),
          });
          if (response.ok) {
            const data = await response.json();
            const responseMessageData = data.choices[0].message.content;
            this.adjectives = responseMessageData.split(", ");
            document.getElementById('adjectiveList').style.display = 'block';
            this.storeAdjectives();
          } else {
            alert('Error occurred while generating adjectives. Please try again.');
          }
        } catch (e) {
          alert('Error occurred while generating adjectives. Please try again.');
        }
      },
      storeAdjectives() {
        localStorage.setItem('adjectives', JSON.stringify(this.adjectives));
      },
      retrieveAdjectives() {
        const adjectives = localStorage.getItem('adjectives');
        if (adjectives) {
          this.adjectives = JSON.parse(adjectives);
          document.getElementById('adjectiveList').style.display = 'block';
        }
      },
      clearAll() {
        this.word = '';
        this.method = 'synonym';
        this.numAdjectives = 1;
        this.adjectives = [];
        document.getElementById('adjectiveList').style.display = 'none';
        localStorage.removeItem('adjectives');
      },
      copyToClipboard(adjective) {
        navigator.clipboard.writeText(adjective);
        alert(`Adjective "${adjective}" copied to clipboard.`);
      },
    },
    mounted() {
      this.retrieveAdjectives();
    },
  });
  app.mount('#app');
</script>
</body>
</html>