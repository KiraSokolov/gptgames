<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Argumentator - Argument Generation Page</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/json5@2/dist/index.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f7f7f7;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            background-color: #ffffff;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .generated-argument {
            border: 1px solid #e0e0e0;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            background-color: #f7f7f7;
        }

        .generated-argument:hover {
            background-color: #e9e9e9;
        }

        h1 {
            font-weight: 500;
            font-size: 28px;
            color: #333;
        }

        label {
            display: block;
            font-weight: 400;
            margin-bottom: 8px;
            margin-top: 20px;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
            outline: none;
            background-color: #fff;
            box-sizing: border-box;
        }

        select {
            padding-right: 32px;
        }

        #characteristics {
            min-height: 140px;
        }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 4px;
            border-radius: 10px;
            background: #e0e0e0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #333;
            border-radius: 50%;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #333;
            border-radius: 50%;
            cursor: pointer;
        }

        button {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            font-weight: 500;
            color: #fff;
            background-color: #3f51b5;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            outline: none;
            transition: background-color 0.2s ease-in-out;
            margin-top: 20px;
        }

        button:hover {
            background-color: #283593;
        }

        .loading {
            font-weight: 500;
            font-size: 16px;
            color: #333;
        }

        h2 {
            font-weight: 500;
            font-size: 22px;
            color: #333;
            margin-bottom: 20px;
        }

        .topic-headline {
            font-weight: 400;
            font-size: 18px;
            color: #333;
            margin-bottom: 10px;
        }

        .argument-characteristics {
            font-size: 14px;
            color: #666;
            margin-bottom: 6px;
        }

        .argument-text {
            font-weight: 500;
            color: #333;
        }
    </style>
</head>
<body>
<div id="app" class="container">
    <h1>Argumentator - The Argument Generator</h1>
    <div id="argumentator" v-if="!isGenerating && arguments.length === 0">
        <label for="topic">Topic/Question/Opinion:</label>
        <input id="topic" type="text" v-model="topic" :placeholder="randomTopic">
        <label for="characteristics">Select Argument Characteristics:<small style="float: right;">Hold CTRL to select
            multiple</small></label>
        <select id="characteristics" multiple v-model="selectedCharacteristics">
            <option v-for="char in characteristics" :value="char">{{ char }}</option>
        </select>

        <label for="numArgs">Number of Arguments to be generated: {{ numArguments }}</label>
        <input id="numArgs" type="range" min="1" max="10" v-model="numArguments">

        <button @click="generateArguments">Generate Arguments</button>
    </div>
    <div v-else-if="isGenerating" class="loading">
        Generating arguments... Please wait. This process can take up to 60 seconds.
    </div>

    <div v-if="arguments.length > 0">
        <h2>Generated Arguments</h2>
        <p class="topic-headline">Topic: {{ topic }}</p>
        <div class="generated-argument" v-for="(arg, index) in arguments" @click="copyToClipboard(arg.argument)">
            <div class="argument-characteristics">Characteristics: {{ arg.characteristics.join(', ') }}</div>
            <div class="argument-text">{{ index + 1 }}. {{ arg.argument }}</div>
        </div>

        <button @click="reset">New Topic</button>
    </div>
</div>
<script>
    const app = Vue.createApp({
        data() {
            return {
                topic: '',
                characteristics: ['Populistic', 'Scientific', 'Factual', 'Emotional', 'Aggravating', 'Provocative', 'Humorous', 'Philosophical', 'Concise', 'Empathetic', 'Inspirational', 'Historical', 'Legal', 'Anecdotal', 'Moral/Ethical', 'Undeniable/Indisputable'],
                selectedCharacteristics: [],
                numArguments: 1,
                arguments: [],
                apiUrl: 'https://chatgpt.tobiasmue91.workers.dev/',
                isGenerating: false,
                topicExamples: [
                    'Pineapple should be an acceptable pizza topping.',
                    'Gene editing should not be used to create "designer babies."',
                    'Zoos should be abolished.',
                    'Living in a small town is better than living in a big city.',
                    'Social media is more harmful than helpful to society.'
                ]
            };
        },
        methods: {
            async generateArguments() {
                // Call the ChatGPT API with the necessary parameters and store the result in this.arguments
                this.isGenerating = true;
                this.arguments = await this.callChatGptAPI();
                this.isGenerating = false;
            },
            async callChatGptAPI() {
                let response = await fetch(this.apiUrl, {
                    'method': 'POST',
                    'headers': {
                        "Content-Type": "application/json",
                        "Accept": "*/*"
                    },
                    'body': JSON.stringify(this.requestData())
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                let data = await response.json();
                const responseContent = data.choices[0].message.content;
                const responseJsonStr = responseContent.substring(
                    responseContent.indexOf("{"),
                    responseContent.lastIndexOf("}") + 1
                );
                const responseJsonData = JSON5.parse(responseJsonStr);

                return responseJsonData['arguments'];
            },
            requestData() {
                return {
                    model: "gpt-3.5-turbo-0301",
                    max_tokens: 2048,
                    messages: this.messageData,
                };
            },
            copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            },
            reset() {
                this.arguments = [];
            }
        },
        computed: {
            messageData() {
                return [
                    {
                        role: "assistant",
                        content: `I am now an API for generating arguments based on user-defined characteristics. On my next message, I will respond in JSON format and provide an array of arguments tailored to the given topic and selected argument characteristics. The JSON format will be as follows: {"arguments":[{"characteristics":["CHARACTERISTIC1","CHARACTERISTIC2",...],"argument":"ARGUMENT_TEXT"}, ...]}. The selected argument characteristics are: ["${this.characteristicsString}]. The user has chosen to generate ${this.numArguments} arguments for the topic "${this.topic}". Please confirm with "OCK!" and I will send you the arguments in the next message.`,
                    },
                    {
                        role: "user",
                        content: `OCK!`,
                    },
                ];
            },
            characteristicsString() {
                return this.selectedCharacteristics.join(', ');
            },
            randomTopic() {
                const randomIndex = Math.floor(Math.random() * this.topicExamples.length)
                return this.topicExamples[randomIndex]
            }
        }
    }).mount('#app');
</script>

</body>
</html>