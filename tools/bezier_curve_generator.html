<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BÃ©zier Curve Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        canvas {
            display: block;
            margin: 0 auto;
            background-color: #f0f0f0;
            cursor: crosshair;
        }
        #controls {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        #controls button {
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <div id="controls">
        <button id="import">Import</button>
        <button id="export">Export</button>
    </div>
    <canvas id="canvas"></canvas>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.15/paper-full.min.js"></script>
    <script>
        paper.install(window);
        const canvas = document.getElementById('canvas');
        paper.setup(canvas);

        const bezierPath = new Path();
        bezierPath.strokeColor = 'black';
        bezierPath.strokeWidth = 2;

        const controlPoints = [];
        const curveHandles = [];

        let activePoint = null;
        let activeHandle = null;

        function createControlPoint(position) {
            const point = new Path.Circle({
                center: position,
                radius: 5,
                fillColor: 'blue',
            });
            point.onMouseDrag = function (event) {
                this.position += event.delta;
                updateBezierPath();
            };
            return point;
        }

        function createCurveHandle(position) {
            const handle = new Path.Circle({
                center: position,
                radius: 3,
                fillColor: 'red',
            });
            handle.onMouseDrag = function (event) {
                this.position += event.delta;
                updateBezierPath();
            };
            return handle;
        }

        function updateBezierPath() {
            bezierPath.segments = [];
            bezierPath.moveTo(controlPoints[0].position);
            for (let i = 0; i < controlPoints.length - 1; i++) {
                const p1 = controlPoints[i].position;
                const p2 = controlPoints[i + 1].position;
                const h1 = curveHandles[i * 2].position;
                const h2 = curveHandles[i * 2 + 1].position;
                bezierPath.cubicCurveTo(h1, h2, p2);
            }
        }

        function addControlPoint(event) {
            const point = createControlPoint(event.point);
            controlPoints.push(point);
            if (controlPoints.length > 1) {
                const handle1 = createCurveHandle(event.point);
                const handle2 = createCurveHandle(event.point);
                curveHandles.push(handle1, handle2);
            }
            updateBezierPath();
        }

        function importCurveData(data) {
            controlPoints.forEach(point => point.remove());
            curveHandles.forEach(handle => handle.remove());
            controlPoints.length = 0;
            curveHandles.length = 0;

            data.controlPoints.forEach(point => {
                controlPoints.push(createControlPoint(new Point(point)));
            });
            data.curveHandles.forEach(handle => {
                curveHandles.push(createCurveHandle(new Point(handle)));
            });
            updateBezierPath();
        }

        function exportCurveData() {
            const data = {
                controlPoints: controlPoints.map(point => point.position),
                curveHandles: curveHandles.map(handle => handle.position),
            };
            return JSON.stringify(data);
        }

        canvas.addEventListener('mousedown', event => {
            if (event.button === 0 && !activePoint && !activeHandle) {
                addControlPoint(event);
            }
        });

        document.getElementById('import').addEventListener('click', () => {
            const data = prompt('Paste the curve data (JSON format):');
            if (data) {
                try {
                    const parsedData = JSON.parse(data);
                    importCurveData(parsedData);
                } catch (error) {
                    alert('Invalid curve data.');
                }
            }
        });

        document.getElementById('export').addEventListener('click', () => {
            const data = exportCurveData();
            prompt('Copy the curve data (JSON format):', data);
        });

        paper.view.draw();
    </script>
</body>
</html>