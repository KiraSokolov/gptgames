<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image Reflection Generator</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" crossorigin="anonymous">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .form-group input[type="file"] {
      display: block;
      margin-top: 5px;
    }
    .form-group input[type="text"] {
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ced4da;
      font-size: 16px;
    }
    .form-group select {
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ced4da;
      font-size: 16px;
    }
    .form-group input[type="range"] {
      width: 100%;
      margin-top: 10px;
    }
    .preview {
      margin-top: 30px;
      text-align: center;
    }
    .preview img {
      max-width: 100%;
      height: auto;
    }
    .reflection {
      margin-top: 30px;
      text-align: center;
    }
    .reflection img {
      max-width: 100%;
      height: auto;
    }
    .download {
      margin-top: 30px;
      text-align: center;
    }
    .download a {
      display: inline-block;
      padding: 10px 20px;
      background-color: #007bff;
      color: #fff;
      border-radius: 5px;
      text-decoration: none;
      font-size: 16px;
      transition: background-color 0.3s ease;
    }
    .download a:hover {
      background-color: #0069d9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Image Reflection Generator</h1>
    <form id="image-form">
      <div class="form-group">
        <label for="image">Upload an image or provide a URL:</label>
        <input type="file" id="image" name="image" accept="image/*">
        <input type="text" id="image-url" name="image-url" placeholder="https://example.com/image.jpg">
      </div>
      <div class="form-group">
        <label for="direction">Direction:</label>
        <select id="direction" name="direction">
          <option value="top">Top</option>
          <option value="bottom">Bottom</option>
          <option value="left">Left</option>
          <option value="right">Right</option>
        </select>
      </div>
      <div class="form-group">
        <label for="amount">Amount:</label>
        <input type="range" id="amount" name="amount" min="0" max="1" step="0.01" value="0">
      </div>
      <div class="form-group">
        <label for="opacity">Opacity:</label>
        <input type="range" id="opacity" name="opacity" min="0" max="1" step="0.01" value="0.5">
      </div>
    </form>
    <div class="preview">
      <h2>Preview:</h2>
      <img id="preview-image" src="https://placehold.co/600x400?text=Placeholder" alt="Preview">
    </div>
    <div class="reflection">
      <h2>Reflection:</h2>
      <img id="reflection-image" src="https://placehold.co/600x400?text=Placeholder" alt="Reflection">
    </div>
    <div class="download">
      <a id="download-link" href="#">Download</a>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.min.js"></script>
  <script>
    $(document).ready(function() {
      bsCustomFileInput.init();
      $('#image').change(function() {
        previewImage(this);
      });
      $('#image-url').on('input', function() {
        previewImage(this);
      });
      $('#direction, #amount, #opacity').change(function() {
        generateReflection();
      });
      $('#download-link').click(function() {
        downloadImage();
      });
    });

    function previewImage(input) {
      if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
          $('#preview-image').attr('src', e.target.result);
          generateReflection();
        }
        reader.readAsDataURL(input.files[0]);
      } else if (input.value) {
        $('#preview-image').attr('src', input.value);
        generateReflection();
      }
    }

    function generateReflection() {
      var canvas = document.createElement('canvas');
      var context = canvas.getContext('2d');
      var image = new Image();
      image.onload = function() {
        canvas.width = image.width;
        canvas.height = image.height * 2;
        context.save();
        context.translate(0, image.height);
        context.scale(1, -1);
        context.drawImage(image, 0, 0, image.width, image.height);
        context.restore();
        var direction = $('#direction').val();
        var amount = $('#amount').val();
        var opacity = $('#opacity').val();
        if (direction == 'top') {
          context.globalAlpha = opacity;
          context.drawImage(canvas, 0, 0, canvas.width, image.height * amount, 0, image.height, canvas.width, image.height * amount);
        } else if (direction == 'bottom') {
          context.globalAlpha = opacity;
          context.drawImage(canvas, 0, image.height * (1 - amount), canvas.width, image.height * amount, 0, image.height * (1 + amount), canvas.width, image.height * amount);
        } else if (direction == 'left') {
          context.globalAlpha = opacity;
          context.drawImage(canvas, 0, 0, canvas.width * amount, image.height, canvas.width * (1 - amount), 0, canvas.width * amount, image.height);
        } else if (direction == 'right') {
          context.globalAlpha = opacity;
          context.drawImage(canvas, canvas.width * (1 - amount), 0, canvas.width * amount, image.height, 0, 0, canvas.width * amount, image.height);
        }
        $('#reflection-image').attr('src', canvas.toDataURL());
      }
      image.src = $('#preview-image').attr('src');
    }

    function downloadImage() {
      var link = document.createElement('a');
      link.download = 'reflection.jpg';
      link.href = $('#reflection-image').attr('src');
      link.click();
    }
  </script>
</body>
</html>